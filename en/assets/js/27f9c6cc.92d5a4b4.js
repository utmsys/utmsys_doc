"use strict";(self.webpackChunkutm_doc=self.webpackChunkutm_doc||[]).push([[2296],{8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var r=t(6540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}},9189:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"System_Config/PX4/network_serial","title":"5.1.1 PX4 Network & Serial","description":"PX4 Ethernet","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/05_System_Config/01_PX4/01_network_serial.md","sourceDirName":"05_System_Config/01_PX4","slug":"/System_Config/PX4/network_serial","permalink":"/en/System_Config/PX4/network_serial","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"5.1.1 PX4 Network & Serial","source":"https://wiki.utmsys.org/System_Config/PX4/network_serial"},"sidebar":"tutorialSidebar","previous":{"title":"5.1 PX4","permalink":"/en/01_PX4"},"next":{"title":"5.2 RDK X5 Module","permalink":"/en/02_RDK X5 Module"}}');var i=t(4848),s=t(8453);const o={title:"5.1.1 PX4 Network & Serial",source:"https://wiki.utmsys.org/System_Config/PX4/network_serial"},c=void 0,a={},l=[{value:"PX4 Ethernet",id:"px4-ethernet",level:2},{value:"PX4 MAVLink Serial Port",id:"px4-mavlink-serial-port",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"px4-ethernet",children:"PX4 Ethernet"}),"\n",(0,i.jsx)(n.p,{children:"Ethernet connections offer a faster, more reliable, and more flexible communications alternative than using USB or other serial connections."}),"\n",(0,i.jsx)(n.p,{children:'It can be used to connect to ground stations, companion computers, and other MAVLink systems. It is particularly recommended for connecting to systems that use Ethernet "natively" (such as IP radios).'}),"\n",(0,i.jsxs)(n.p,{children:["PX4 uses the ",(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/modules/modules_system.html#netman",children:"netman"})," module to apply and update network settings."]}),"\n",(0,i.jsxs)(n.p,{children:["The default configuration will first request an IP address from DHCP, and if that fails, will fall back to the default static address ",(0,i.jsx)(n.code,{children:"10.41.10.2"}),". You can explicitly set any static IP address (including the default address) to bypass the initial DHCP check, which will speed up the connection."]}),"\n",(0,i.jsxs)(n.p,{children:["The network settings are defined in a configuration file on the SD card ",(0,i.jsx)(n.code,{children:"/fs/microsd/net.cfg"}),". This is a text file with one setting per line, and each setting corresponds to a ",(0,i.jsx)(n.code,{children:"name=value"})," configuration file. A configuration file might look like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-markdown",children:"DEVICE=eth0\nBOOTPROTO=fallback\nIPADDR=10.41.10.2\nNETMASK=255.255.255.0\nROUTER=10.41.10.254\nDNS=10.41.10.254\n"})}),"\n",(0,i.jsx)(n.p,{children:"The values are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DEVICE"}),": Interface name. Defaults to ",(0,i.jsx)(n.code,{children:"eth0"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"BOOTPROTO"}),": Protocol for obtaining the PX4 IP address. Valid values for proto are: ",(0,i.jsx)(n.code,{children:"dhcp"}),", ",(0,i.jsx)(n.code,{children:"static"}),", ",(0,i.jsx)(n.code,{children:"fallback"})," (use DHCP, but if that fails, revert to a static address after a while)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"IPADDR"}),": Static IP address ( ",(0,i.jsx)(n.code,{children:"static"})," used if BOOTPROTO is or ",(0,i.jsx)(n.code,{children:"fallback"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"NETMASK"}),":Network"," mask"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ROUTER"}),": The address of the default route."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DNS"}),": DNS server address."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:'To set up the above "example" configuration using QGroundControl:'}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Connect the flight controller to your computer using a USB cable."}),"\n",(0,i.jsxs)(n.li,{children:["Open ",(0,i.jsx)(n.strong,{children:"QGroundcontrol > Analysis Tools > MAVLink Console"})]}),"\n",(0,i.jsxs)(n.li,{children:["Enter a command similar to the following in the MAVLink console (to write the value to the configuration file):","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-markdown",children:"echo DEVICE=eth0 > /fs/microsd/net.cfg\necho BOOTPROTO=fallback >> /fs/microsd/net.cfg\necho IPADDR=10.41.10.2 >> /fs/microsd/net.cfg\necho NETMASK=255.255.255.0 >>/fs/microsd/net.cfg\necho ROUTER=10.41.10.254 >>/fs/microsd/net.cfg\necho DNS=10.41.10.254 >>/fs/microsd/net.cfg\n"})}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Once the network configuration is set up, you can disconnect the USB cable."}),"\n",(0,i.jsx)(n.li,{children:"Restart the flight controller to apply the settings."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Note that the above settings already provide an Ethernet address for the flight controller. You will also need to ",(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/ethernet_setup.html#px4-mavlink-serial-port-configuration",children:"configure the Ethernet port"})," to use MAVLink."]}),"\n",(0,i.jsx)(n.h2,{id:"px4-mavlink-serial-port",children:"PX4 MAVLink Serial Port"}),"\n",(0,i.jsx)(n.p,{children:"The Ethernet port configuration sets the properties of the serial link (i.e. how PX4 sees the Ethernet connection). This includes the MAVLink message set that is streamed, the data rate, the UDP port that remote systems can connect to and listen on, etc."}),"\n",(0,i.jsx)(n.p,{children:"Configure the PX4 serial port to connect to the GCS via MAVLink, using the parameters shown below:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"scope"}),(0,i.jsx)(n.th,{children:"value"}),(0,i.jsx)(n.th,{children:"describe"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_CONFIG",children:"MAV_2_CONFIG"})}),(0,i.jsx)(n.td,{children:"1000"}),(0,i.jsx)(n.td,{children:"Configuring Ethernet Ports"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_BROADCAST",children:"MAV_2_BROADCAST"})}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsxs)(n.td,{children:["Broadcast ",(0,i.jsx)(n.code,{children:"HEARTBEAT"})," Message"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_MODE",children:"MAV_2_MODE"})}),(0,i.jsx)(n.td,{children:"0"}),(0,i.jsx)(n.td,{children:'Sending a "normal" MAVLink message set (i.e. GCS setup)'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_RADIO_CTL",children:"MAV_2_RADIO_CTL"})}),(0,i.jsx)(n.td,{children:"0"}),(0,i.jsx)(n.td,{children:"Disable software restrictions for MAVLink traffic"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_RATE",children:"MAV_2_RATE"})}),(0,i.jsx)(n.td,{children:"100000"}),(0,i.jsx)(n.td,{children:"Maximum sending rate"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_REMOTE_PRT",children:"MAV_2_REMOTE_PRT"})}),(0,i.jsx)(n.td,{children:"14550"}),(0,i.jsx)(n.td,{children:"MAVLink remote port 14550 (GCS)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_UDP_PRT",children:"MAV_2_UDP_PRT"})}),(0,i.jsx)(n.td,{children:"14550"}),(0,i.jsx)(n.td,{children:"MAVLink network port 14550 (GCS)"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Typically, the companion computer will use the port ",(0,i.jsx)(n.code,{children:"14540"})," (instead of ",(0,i.jsx)(n.code,{children:"14550"}),") and transmit the MAVLink message set specified in the configuration file ",(0,i.jsx)(n.code,{children:"Onboard"}),". You can configure this by changing ",(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_REMOTE_PRT",children:"MAV_2_REMOTE_PRT"})," and ",(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_UDP_PRT",children:"MAV_2_UDP_PRT"})," to, ",(0,i.jsx)(n.code,{children:"14540"})," and changing ",(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/advanced_config/parameter_reference.html#MAV_2_MODE",children:"MAV_2_MODE"})," ",(0,i.jsx)(n.code,{children:"2"})," to (Onboard). However, please note that using the GCS configuration file will still work correctly."]}),"\n",(0,i.jsxs)(n.p,{children:["For more information on MAVLink serial port configuration, see ",(0,i.jsx)(n.a,{href:"https://docs.px4.io/main/en/peripherals/mavlink_peripherals.html",children:"MAVLink Peripherals (GCS/OSD/Companion)"})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);
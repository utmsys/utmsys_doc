"use strict";(self.webpackChunkutm_doc=self.webpackChunkutm_doc||[]).push([[8242],{1309:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Algorithm_Development/RL/ChampionLevelDroneRacing/Swift","title":"Swift","description":"Source//www.nature.com/articles/s41586-023-06419-4","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/09_Algorithm_Development/06_RL/ChampionLevelDroneRacing/Swift.md","sourceDirName":"09_Algorithm_Development/06_RL/ChampionLevelDroneRacing","slug":"/Algorithm_Development/RL/ChampionLevelDroneRacing/Swift","permalink":"/en/Algorithm_Development/RL/ChampionLevelDroneRacing/Swift","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"source":"https://wiki.utmsys.org/Algorithm_Development/RL/ChampionLevelDroneRacing/%E4%BD%BF%E7%94%A8%E6%B7%B1%E5%BA%A6%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%86%A0%E5%86%9B%E7%BA%A7Swift%E6%97%A0%E4%BA%BA%E6%9C%BA%E7%AB%9E%E9%80%9F%E7%B3%BB%E7%BB%9F"},"sidebar":"tutorialSidebar","previous":{"title":"9.6 \u5f3a\u5316\u5b66\u4e60","permalink":"/en/06_RL"},"next":{"title":"DiffPhysDrone","permalink":"/en/Algorithm_Development/RL/DifferentiablePhysicsDrone/DiffPhysDrone"}}');var r=i(4848),a=i(8453);const o={source:"https://wiki.utmsys.org/Algorithm_Development/RL/ChampionLevelDroneRacing/%E4%BD%BF%E7%94%A8%E6%B7%B1%E5%BA%A6%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%86%A0%E5%86%9B%E7%BA%A7Swift%E6%97%A0%E4%BA%BA%E6%9C%BA%E7%AB%9E%E9%80%9F%E7%B3%BB%E7%BB%9F"},s=void 0,l={},d=[{value:"Abstract",id:"abstract",level:2},{value:"Main",id:"main",level:2},{value:"Swift",id:"swift",level:2},{value:"Results",id:"results",level:2},{value:"Discussion",id:"discussion",level:2},{value:"Methods",id:"methods",level:2},{value:"Quadrotor",id:"quadrotor",level:3},{value:"Quadrotor",id:"quadrotor-1",level:4},{value:"Aerodynamics and",id:"aerodynamics-and",level:4},{value:"Betaflight low-level",id:"betaflight-low-level",level:4},{value:"Battery Model and",id:"battery-model-and",level:4},{value:"Strategy",id:"strategy",level:3},{value:"Training",id:"training",level:4},{value:"Observe, act, and",id:"observe-act-and",level:4},{value:"Training",id:"training-1",level:4},{value:"Residual Model",id:"residual-model",level:3},{value:"Residual Observation",id:"residual-observation",level:4},{value:"Residual Dynamics",id:"residual-dynamics",level:4},{value:"Door",id:"door",level:3},{value:"VIO drift",id:"vio-drift",level:3},{value:"Simulation",id:"simulation",level:3},{value:"after multiple iterations",id:"after-multiple-iterations",level:3},{value:"Drone hardware",id:"drone-hardware",level:3},{value:"Human pilot",id:"human-pilot",level:3},{value:"Research",id:"research",level:3},{value:"Data",id:"data",level:2},{value:"Code",id:"code",level:2},{value:"More",id:"more",level:2}];function h(e){const t={a:"a",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:["Source: ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4",children:"https://www.nature.com/articles/s41586-023-06419-4"})]}),"\n",(0,r.jsx)(t.h2,{id:"abstract",children:"Abstract"}),"\n",(0,r.jsx)(t.p,{children:"First-person perspective (FPV) drone racing is a televised sport in which professional competitors pilot high-speed aircraft across a 3D track. Each pilot observes the surrounding environment from the drone's perspective using video feeds from an onboard camera. Achieving the level of autonomous drone control achieved by professional pilots is challenging because the robot needs to fly within limits while estimating its speed and position on the track using only onboard sensors[^1]. Here we present Swift, an autonomous system that can race against human world champion-level physical vehicles. The system combines deep reinforcement learning (RL) in simulation with data collected in the real world. Swift competed in real-world head-to-head races against three human champions, including two world champions from international leagues. Swift won several races against each human champion and set the fastest race time. This work represents a milestone in mobile robotics and machine intelligence[^2] and may inspire the deployment of hybrid learning-based solutions in other physical systems."}),"\n",(0,r.jsx)(t.h2,{id:"main",children:"Main"}),"\n",(0,r.jsxs)(t.p,{children:["Deep reinforcement learning [^3] has driven some of the recent advances in artificial intelligence. Policies trained using deep reinforcement learning have outperformed humans in complex competitive games, including Atari ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"4, 5, 6 "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Schrittwieser, J. et al. Mastering Atari, Go, chess, and shogi by planning with learned models. Nature 588, 604\u2013609 (2020).",href:"https://www.nature.com/articles/#ref-CR5",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"Go "})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"References 6",title:"Ecoffet, A., Huizinga, J., Lehman, J., Stanley, KO & Clune, J. Return first, explore later. Nature 590, 580\u2013586 (2021).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR6",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"5, 7, 8, 9 "})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Mnih, V. et al. Towards human-level control through deep reinforcement learning. Nature 518, 529\u2013533 (2015).",href:"https://www.nature.com/articles/#ref-CR4",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:","})})})})})})," Chess 5 ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Silver, D. \u7b49\u4eba\u3002\u300a\u5229\u7528\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u548c\u6811\u5f62\u641c\u7d22\u638c\u63e1\u56f4\u68cb\u6e38\u620f\u300b\u3002\u300a\u81ea\u7136\u300b529, 484\u2013489 (2016)\u3002",href:"https://www.nature.com/articles/#ref-CR7",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"References 5",title:"Schrittwieser, J. et al. Mastering Atari, Go, chess, and shogi by planning with learned models. Nature 588, 604\u2013609 (2020).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR5",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"9"})})})})})}),(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"StarCraft"})})})})," [^10] ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", "})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Silver, D. \u7b49\u4eba\u3002\u65e0\u9700\u4eba\u7c7b\u77e5\u8bc6\u5373\u53ef\u638c\u63e1\u56f4\u68cb\u6e38\u620f\u3002\u300a\u81ea\u7136\u300b550, 354\u2013359 (2017)\u3002",href:"https://www.nature.com/articles/#ref-CR8",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"Dota"})})})})," 2 ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 5",title:"Schrittwieser, J. \u7b49\u4eba\u3002\u901a\u8fc7\u5b66\u4e60\u6a21\u578b\u8fdb\u884c\u89c4\u5212\uff0c\u638c\u63e1\u96c5\u8fbe\u5229\u3001\u56f4\u68cb\u3001\u56fd\u9645\u8c61\u68cb\u548c\u5c06\u68cb\u3002\u300a\u81ea\u7136\u300b588, 604\u2013609 (2020)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR5",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"( "})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 9",title:"Silver, D. \u7b49\u4eba\u3002\u4e00\u79cd\u901a\u8fc7\u81ea\u6211\u5bf9\u5f08\u638c\u63e1\u56fd\u9645\u8c61\u68cb\u3001\u5c06\u68cb\u548c\u56f4\u68cb\u7684\u901a\u7528\u5f3a\u5316\u5b66\u4e60\u7b97\u6cd5\u3002Science 362, 1140\u20131144 (2018)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR9",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"Ref"})})})})}),". [^11] ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:") "})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", and"})})})," Gran Turismo ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 12",title:"Fuchs, F.\u3001Song, Y.\u3001Kaufmann, E.\u3001Scaramuzza, D. \u548c D\xfcrr, P. \u5229\u7528\u6df1\u5ea6\u5f3a\u5316\u5b66\u4e60\u5728 Gran Turismo Sport \u4e2d\u5b9e\u73b0\u8d85\u4eba\u8868\u73b0\u3002IEEE Robot. Autom. Lett. 6, 4257\u20134264 (2021)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR12",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"12, 13. These impressive "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 11",title:"Berner, C. \u7b49\u4eba\u3002\u57fa\u4e8e\u5927\u89c4\u6a21\u6df1\u5ea6\u5f3a\u5316\u5b66\u4e60\u7684 Dota 2\u3002\u9884\u5370\u672c\u94fe\u63a5\uff1ahttps://arxiv.org/abs/1912.06680 (2019)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR11",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"demonstrations of machine intelligence have been primarily limited to simulations and"})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 13",title:"Wurman, PR \u7b49\u4eba\u3002\u5229\u7528\u6df1\u5ea6\u5f3a\u5316\u5b66\u4e60\u8d85\u8d8a Gran Turismo \u8d5b\u8f66\u51a0\u519b\u8f66\u624b\u3002\u300a\u81ea\u7136\u300b602, 223\u2013228 (2022)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR13",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"board game environments that allow for policy search in precisely replicated test conditions. Overcoming this limitation and demonstrating championship-level performance in competitive sports is a "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 16",title:"Won, D.-O.\u3001M\xfcller, K.-R. \u548c Lee, S.-W. \u81ea\u9002\u5e94\u6df1\u5ea6\u5f3a\u5316\u5b66\u4e60\u6846\u67b6\u4f7f\u51b0\u58f6\u673a\u5668\u4eba\u5728\u73b0\u5b9e\u6761\u4ef6\u4e0b\u5177\u6709\u7c7b\u4f3c\u4eba\u7c7b\u7684\u8868\u73b0\u3002\u300a\u673a\u5668\u4eba\u79d1\u5b66\u300b5, eabb9764 (2020)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR16",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"long - "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Spielberg, NA, Brown, M., Kapania, NR, Kegelman, JC & Gerdes, JC. \u7528\u4e8e\u9ad8\u6027\u80fd\u81ea\u52a8\u9a7e\u9a76\u7684\u795e\u7ecf\u7f51\u7edc\u8f66\u8f86\u6a21\u578b\u3002\u300a\u673a\u5668\u4eba\u79d1\u5b66\u300b\uff0c\u7b2c4\u5377\uff0ceaaw1975\u671f\uff082019\uff09\u3002",href:"https://www.nature.com/articles/#ref-CR15",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"standing"})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"problem"})})})," in autonomous mobile robotics and artificial intelligence ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Funke, J. \u7b49\u4eba\u5728 2012 IEEE \u667a\u80fd\u6c7d\u8f66\u7814\u8ba8\u4f1a\u8bba\u6587\u96c6 541\u2013547 \u4e2d\uff08IEEE\uff0c2012 \u5e74\uff09\u3002",href:"https://www.nature.com/articles/#ref-CR14",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"14, 15, 16"})})})}),(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"."})})})]}),"\n",(0,r.jsxs)(t.p,{children:["FPV drone racing is a televised sport in which highly trained human pilots push aircraft to their physical limits through high-speed, agile maneuvers (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig1",children:"1a"})," ). The aircraft used in FPV racing are quadcopters, which are among the most agile machines ever created (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig1",children:"1b"})," ). During competition, the aircraft exert forces exceeding five times their own weight or more, reaching speeds exceeding 100 km h\u207b\xb9 ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"and"})})})})}),' accelerations several times greater than gravity, even in confined spaces. Each aircraft is remotely controlled by a human pilot wearing a headset that displays a video stream from an onboard camera, creating an immersive "first-person perspective" experience (Figure ',(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig1",children:"1c"})," )."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-023-06419-4/MediaObjects/41586_2023_6419_Fig1_HTML.png?as=webp",alt:"Figure 1"})}),"\n",(0,r.jsx)(t.p,{children:"Figure 1: Drone racing."}),"\n",(0,r.jsxs)(t.p,{children:["Attempts to create autonomous systems that can match the performance of human pilots can be traced back to the first autonomous drone race in 2016 (Ref. [^17] ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 17",title:"Moon, H., Sun, Y., Baltes, J., and Kim, SJ. \u201cIROS 2016 Competition.\u201d IEEE Robot. Autom. Mag. 24, 20\u201329 (2017).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR17",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:")"})})})})})}),". A series of innovations followed, including using deep networks to identify the next gate location, ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"18,19,20 "})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 20",title:"Zhang, D. and Doyle, D.D., in Proc. 2020 IEEE Conference on Aeronautics and Astronautics, 1\u201311 (IEEE, 2020).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR20",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"transferring "})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Jung, S., Hwang, S., Shin, H. & Shim, DH, \u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u5ba4\u5185\u81ea\u4e3b\u65e0\u4eba\u673a\u7ade\u901f\u611f\u77e5\u3001\u5236\u5bfc\u548c\u5bfc\u822a\u3002IEEE Robot. Autom. Lett. 3, 2539\u20132544 (2018)\u3002",href:"https://www.nature.com/articles/#ref-CR18",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"race"})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"strategies "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 24",title:"Li, S., van der Horst, E., Duernay, P., De Wagter, C. & de Croon, GC. \u89c6\u89c9\u6a21\u578b\u9884\u6d4b\u5b9a\u4f4d\uff0c\u5b9e\u73b072g\u65e0\u4eba\u673a\u9ad8\u6548\u81ea\u4e3b\u7ade\u901f\u3002\u300aJ. Field Robot\u300b\u6742\u5fd7\uff0c\u7b2c37\u5377\uff0c\u7b2c667\u2013692\u9875\uff082020\u5e74\uff09\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR24",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"from"})})})})," simulation to reality ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:",21,22 "})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 21",title:"Loquercio, A. \u7b49\u4eba\u3002\u6df1\u5ea6\u65e0\u4eba\u673a\u7ade\u901f\uff1a\u901a\u8fc7\u9886\u57df\u968f\u673a\u5316\u4ece\u6a21\u62df\u5230\u73b0\u5b9e\u3002IEEE \u673a\u5668\u4eba\u5b66\u62a5\uff0c36, 1\u201314 (2019)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR21",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"and"})})})})})," accounting for uncertainty in perception, ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 25",title:"\u4eba\u5de5\u667a\u80fd\u6b63\u5728\u9a7e\u9a76\u65e0\u4eba\u673a\uff08\u901f\u5ea6\u975e\u5e38\u975e\u5e38\u6162\uff09\u3002https://www.nytimes.com/2019/03/26/technology/alphapilot-ai-drone-racing.html (2019)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR25",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"23,24"})})})})}),(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:". The 2019 "})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 23",title:"Kaufmann\uff0cE.\u7b49\u4eba\u57282019\u5e74\u56fd\u9645\u673a\u5668\u4eba\u4e0e\u81ea\u52a8\u5316\u4f1a\u8bae\uff08ICRA\uff09\u7b2c690\u2013696\u671f\uff08IEEE\uff0c2019\u5e74\uff09\u4e2d\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR23",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"AlphaPilot"})})})})})," autonomous drone race showcased some of the best research in this area.25 However, the top two teams still took almost twice as long as professional human pilots to complete the course.26,27 ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 27",title:"Wagter, CD, Paredes-Vall\xe9, F., Sheth, N. \u548c de Croon, G. 2019 \u5e74\u4eba\u5de5\u667a\u80fd\u673a\u5668\u4eba\u7ade\u8d5b\u83b7\u80dc\u4f5c\u54c1\u80cc\u540e\u7684\u611f\u77e5\u3001\u72b6\u6001\u4f30\u8ba1\u548c\u63a7\u5236\u3002\u300a\u91ce\u5916\u673a\u5668\u4eba\u300b\u30022, 1263\u20131290 (2022)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR27",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"More "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 22",title:"Loquercio, A. \u7b49\u4eba\u3002\u300a\u5b66\u4e60\u91ce\u5916\u9ad8\u901f\u98de\u884c\u300b\u3002\u300a\u673a\u5668\u4eba\u79d1\u5b66\u300b\uff0c\u7b2c 6 \u5377\uff0ceabg5810 \u9875\uff082021 \u5e74\uff09\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR22",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"recently "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 26",title:"Foehn, P. \u7b49\u4eba\u3002AlphaPilot\uff1a\u81ea\u4e3b\u65e0\u4eba\u673a\u7ade\u901f\u3002Auton. Robots 46, 307\u2013320 (2021)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR26",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:","})})})})})," autonomous systems have begun to match the performance of human experts.28,29,30 ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"However, these efforts rely "})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Foehn, P.\u3001Romero, A. \u548c Scaramuzza, D. \u56db\u65cb\u7ffc\u822a\u70b9\u98de\u884c\u7684\u65f6\u95f4\u6700\u4f18\u89c4\u5212\u3002\u300a\u673a\u5668\u4eba\u79d1\u5b66\u300b\uff0c\u7b2c 6 \u5377\uff0ceabh1221 \u9875\uff082021 \u5e74\uff09\u3002",href:"https://www.nature.com/articles/#ref-CR28",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"on"})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"near- perfect state estimates "})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"provided by external motion capture systems. This makes "})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{title:"Romero, A.\u3001Sun, S.\u3001Foehn, P. \u548c Scaramuzza, D. \u65f6\u95f4\u6700\u4f18\u56db\u65cb\u7ffc\u98de\u884c\u7684\u6a21\u578b\u9884\u6d4b\u8f6e\u5ed3\u63a7\u5236\u3002IEEE \u673a\u5668\u4eba\u5b66\u62a5\uff0c38, 3340\u20133356 (2022)\u3002",href:"https://www.nature.com/articles/#ref-CR29",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"comparisons with human pilots "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 30",title:"Sun, S., Romero, A., Foehn, P., Kaufmann, E. & Scaramuzza, D. \u975e\u7ebf\u6027MPC\u4e0e\u57fa\u4e8e\u5dee\u5206\u5e73\u5766\u5ea6\u7684\u56db\u65cb\u7ffc\u654f\u6377\u98de\u884c\u63a7\u5236\u6bd4\u8f83\u7814\u7a76\u3002IEEE\u673a\u5668\u4eba\u5b66\u62a5\uff0c38, 3357\u20133373 (2021)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR30",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"unfair"})})})}),", as humans only have access to onboard observations from the drone."]}),"\n",(0,r.jsx)(t.p,{children:"This paper introduces Swift, an autonomous flight system that can fly a quadrotor in a competition against a human world champion using only onboard sensors and computational power. Swift consists of two key modules: (1) a perception system that converts high-dimensional visual and inertial information into low-dimensional representations; and (2) a control policy that takes the low-dimensional representations generated by the perception system and generates control commands."}),"\n",(0,r.jsx)(t.p,{children:"The control policy is represented by a feedforward neural network and trained in simulation using model-free on-policy deep reinforcement learning [^31]. To bridge the gap between the simulation and the physical world in terms of perception and dynamics, we utilize non-parametric empirical noise models estimated from data collected from the physical system. These empirical noise models have been shown to be crucial for successfully transferring control policies from simulation to the real world."}),"\n",(0,r.jsxs)(t.p,{children:["We evaluated Swift on a physical track designed by professional drone racing pilots (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig1",children:"1a"})," ). The track consisted of seven square gates measuring 30 \xd7 30 \xd7 8 meters, forming a 75-meter lap. Swift competed against three human champions on this track: 2019 Drone Racing League World Champion Alex Vanover, two-time MultiGP International Open World Cup champion Thomas Bitmatta, and three-time Swiss National Champion Marvin Schaepper. The quadrotors used by Swift and the human pilots had the same weight, shape, and propulsion. They are similar to drones used in international competitions."]}),"\n",(0,r.jsxs)(t.p,{children:["The human pilots practiced on the track for a week. Afterward, each pilot competed in several head-to-head races against Swift (Figures ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig1",children:"1a, b"})," ). In each head-to-head race, two drones (one controlled by a human pilot and one by Swift) started from the podium. The race began with an acoustic signal. The first drone to complete three full laps of the track, passing through all gates in the correct order on each lap, won the race."]}),"\n",(0,r.jsx)(t.p,{children:"Swift defeated every human pilot in the competition and set the fastest time in the event. To our knowledge, this is the first time an autonomous mobile robot has achieved world championship-level performance in a real-world competitive sport."}),"\n",(0,r.jsx)(t.h2,{id:"swift",children:"Swift"}),"\n",(0,r.jsxs)(t.p,{children:["Swift combines learning-based and traditional algorithms to map onboard sensor readings to control commands. This mapping consists of two parts: (1) an observation strategy, which distills high-dimensional visual and inertial information into a task-specific, low-dimensional encoding; and (2) a control strategy, which converts the encoding into instructions for the drone. A schematic diagram of the system is shown in Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig2",children:"2"}),"."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-023-06419-4/MediaObjects/41586_2023_6419_Fig2_HTML.png?as=webp",alt:"Figure 2"})}),"\n",(0,r.jsx)(t.p,{children:"Figure 2: Swift system."}),"\n",(0,r.jsxs)(t.p,{children:["The observation policy consists of a visual-inertial estimator ",(0,r.jsxs)("sup",{children:[(0,r.jsx)("a",{"aria-label":"Reference 32",title:"Scaramuzza, D. and Zhang, Z. Encyclopedia of Robotics (Ang, M., Khatib, O. and Siciliano, B. eds.) 1\u20139 (Springer, 2019).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR32",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"32, 33"})})})})}),(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", which "})})})})]})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 26",title:"Foehn, P. et al. AlphaPilot: Autonomous drone racing. Auton. Robots 46, 307\u2013320 (2021).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR26",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"operates in conjunction"})})})})})})," with a gate detector 26, a convolutional neural network that ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 33",title:"Huang, G. In Proceedings of the 2019 International Conference on Robotics and Automation (ICRA) 9572\u20139582 (IEEE, 2019).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR33",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"detects"})})})})})," race gates in the onboard imagery. The detected gates are then used to estimate the drone's global position and orientation along the track. This is done using a camera resection algorithm [^34] in conjunction with the track map. The global pose estimate obtained from the gate detector is then combined with the estimate from the visual-inertial estimator via a Kalman filter to more accurately represent the robot's state. The control policy is represented by a two-layer perceptron that maps the output of the Kalman filter to control commands for the drone. The policy is ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 31",title:"Schulman, J., Wolski, F., Dhariwal, P., Radford, A., and Klimov, O. Proximal Policy Optimization Algorithms. Preprint link: https://arxiv.org/abs/1707.06347 (2017).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR31",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"trained in simulation using policy-based model-free deep reinforcement learning 31. During training, the policy maximizes"})})})})})})," the reward for approaching the next race gate [^35] combined with the perceptual goal of keeping the next gate within the camera's field of view. Seeing the next gate is rewarded because it increases the accuracy of the pose estimate."]}),"\n",(0,r.jsx)(t.p,{children:"Optimizing a policy solely through simulation can lead to poor performance on physical hardware if the discrepancies between simulation and reality are not eliminated. These discrepancies are primarily due to two factors: (1) the difference between simulated and real-world dynamics, and (2) the noisy estimate of the robot state made by the observation policy when fed real-world sensor data. We mitigate these discrepancies by collecting a small amount of real-world data and leveraging this data to improve the realism of the simulator."}),"\n",(0,r.jsxs)(t.p,{children:["Specifically, as the UAV drives around the track, we record observations from the robot\u2019s onboard sensors along with high-precision pose estimates from a motion capture system. During this data collection phase, the robot is controlled by a policy trained in simulation that operates on the pose estimates provided by the motion capture system. The recorded data allows the identification of characteristic failure modes in perception and dynamics observed through the track. The complexity of these perception failures and unmodeled dynamics depends on the environment, platform, track, and sensors. Perception and dynamic residuals are modeled using Gaussian processes [^36] and ",(0,r.jsx)(t.em,{children:"k-"})," nearest neighbor regression, respectively. This choice is motivated by our empirical finding that perception residuals are stochastic, while dynamic residuals are largely deterministic (Extended Data Fig. ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig5",children:"1"})," ). These residual models are integrated into the simulation, and the racing policy is fine-tuned in this augmented simulation. This approach is related to the empirical actuator model used for simulation-to-reality transfer in Ref. [^37] but goes further by incorporating empirical modeling of the perception system and accounting for the stochastic nature of the platform state estimates."]}),"\n",(0,r.jsxs)(t.p,{children:["We eliminated each component of Swift in controlled experiments reported in the Extended Data. Furthermore, we compared it with recent work using traditional methods, including trajectory planning and model predictive control (MPC), to solve autonomous drone racing tasks. While such methods achieve comparable or even superior performance to ours under ideal conditions (such as simplified dynamics and perfect knowledge of the robot's state), their performance collapses when their assumptions are violated. We found that ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 29",title:"Romero, A.\u3001Sun, S.\u3001Foehn, P. \u548c Scaramuzza, D. \u65f6\u95f4\u6700\u4f18\u56db\u65cb\u7ffc\u98de\u884c\u7684\u6a21\u578b\u9884\u6d4b\u8f6e\u5ed3\u63a7\u5236\u3002IEEE \u673a\u5668\u4eba\u5b66\u62a5\uff0c38, 3340\u20133356 (2022)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR29",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"methods that rely on precomputed paths28 "})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 28",title:"Foehn, P., Romero, A. and Scaramuzza, D. Time-optimal planning of waypoint flight for quadrotors. Robotics, vol. 6, p. eabh1221 (2021).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR28",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", 29"})})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"are particularly sensitive to noisy perception and dynamics. Even equipped with high-precision state estimates from motion capture systems, traditional methods"})})})})," fail to achieve lap times competitive with Swift or human world champions. Detailed analysis is provided in the Extended Data."]}),"\n",(0,r.jsx)(t.h2,{id:"results",children:"Results"}),"\n",(0,r.jsxs)(t.p,{children:["Drone races are conducted on courses designed by external, world-class FPV pilots. These courses are filled with unique maneuvers and challenges, such as the Split-S (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig1",children:"1a"})," (top right) and ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig4",children:"Figure 4d"})," ). Even in the event of a collision, pilots can continue the race, provided their drones are still able to fly. If both drones collide and are unable to complete the race, the drone that travels further on the course wins."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig3",children:"As shown in Figure 3b"}),", Swift won 5 of 9 races against A. Vanover, 4 of 7 against T. Bitmatta, and 6 of 9 against M. Schaepper. Of Swift's 10 losses, 40% were due to collisions with opponents, 40% were due to collisions with gates, and 20% were due to the drone being slower than the human pilot. Overall, Swift won every race against the human pilot. Swift also set the fastest time, beating the best time by a human pilot (A. Vanover) by half a second."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-023-06419-4/MediaObjects/41586_2023_6419_Fig3_HTML.png?as=webp",alt:"Figure 3"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Figure 3: Results."})}),"\n",(0,r.jsxs)(t.p,{children:["Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig4",children:"4"})," and Extended Data Table ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Tab1",children:"1d"})," analyze the fastest laps flown by Swift and each human pilot. Although Swift was faster overall than all human pilots, it was not faster on all individual sections of the track (Extended Data Table ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Tab1",children:"1"})," ). Swift was consistently faster at the start and in tight turns, such as the forked S. At the start, Swift had a shorter reaction time, starting 120 milliseconds earlier than the human pilots on average. Furthermore, it accelerated faster, reaching a higher speed when entering the first gate (Extended Data Table ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Tab1",children:"1d"}),", segment 1). In tight turns, ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig4",children:"as shown in Figures 4c and 4d, Swift was able to find more compact maneuvers. One hypothesis is that Swift optimizes its trajectory over longer timescales than the human pilots. Model-free RL is known to"})," optimize long-term rewards via a value function [^38]. In contrast, human pilots plan their movements over shorter timescales, at most one gate ahead [^39]. This is evident , for example, in segment S (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig4",children:"4b, d"})," ), where the human pilot was faster at the beginning and end of the maneuver but slower overall (Extended Data Table ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Tab1",children:"1d"}),", segment 3). Furthermore, the human pilot maneuvered the aircraft toward the next gate earlier than Swift (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig4",children:"4c, d"})," ). We believe that the human pilot was accustomed to keeping the upcoming gate in view, while Swift had learned to rely on other cues for certain maneuvers, such as inertial data and visual odometry for features in the surrounding environment. Overall, averaged across the entire course, the autonomous drone achieved the highest average speed, found the shortest course, and managed to keep the aircraft closer to its driving limit throughout the race, as shown by average thrust and power (Extended Data Table ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Tab1",children:"1d"})," )."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-023-06419-4/MediaObjects/41586_2023_6419_Fig4_HTML.png?as=webp",alt:"Figure 4"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Figure 4: Analysis."})}),"\n",(0,r.jsxs)(t.p,{children:["We also compared Swift's performance with that of a human champion in a time trial (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig3",children:"3a"})," ). In a time trial, a single pilot races around a track, completing laps at the pilot's discretion. We accumulated time trial data from practice weeks and races, including training runs (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig3",children:"3a"}),", color) and laps flown under race conditions (Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig3",children:"3a"}),", black). For each competitor, we used over 300 laps to calculate statistics. The autonomous drone more consistently pursued faster lap times, exhibiting lower mean and variance. In contrast, the human pilot made lap-by-lap decisions about whether to pursue speed, both during training and during the race, resulting in higher mean and variance lap times. The ability to adjust flight strategy allows the human pilot to maintain a slower speed when they find themselves significantly ahead, reducing the risk of a crash. The autonomous drone, unaware of its opponent, will always strive for the fastest expected finish time, potentially taking too much risk when ahead and too little risk when trailing by ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 40",title:"Spica, R., Cristofalo, E., Wang, Z., Montijano, E., and Schwager, M. A real-time game-theoretic planner for autonomous two-player drone racing. IEEE Transactions on Robotics, 36, 1389\u20131403 (2020).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR40",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"40 seconds"})})})})})}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"discussion",children:"Discussion"}),"\n",(0,r.jsxs)(t.p,{children:["FPV drone racing requires real-time decision-making based on noisy and incomplete sensory input from the physical environment. We propose an autonomous physical system that can achieve championship-level performance in this sport, matching and sometimes exceeding the performance of human world champions. Our system has certain structural advantages over human pilots. First, it utilizes inertial data from an onboard inertial measurement unit32 ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 32",title:"Scaramuzza, D. and Zhang, Z. Encyclopedia of Robotics (Ang, M., Khatib, O. and Siciliano, B. eds.) 1\u20139 (Springer, 2019).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR32",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"."})})})})})})," This is similar to the human vestibular system[^41], which human pilots do not use because they are not in the aircraft and cannot feel the accelerations acting on it. Second, our system benefits from lower sensorimotor latency (40 milliseconds for Swift, compared to an average of 220 milliseconds for professional human pilots[^39]). On the other hand, the limited refresh rate of the camera used by Swift (30 Hz) can be considered a structural advantage over human pilots, whose camera refresh rate is four times higher than that of human pilots (120 Hz), thereby improving their reaction time[^42]."]}),"\n",(0,r.jsx)(t.p,{children:"Human pilots are impressively robust: they can continue flying and completing the track even after a full-speed crash\u2014if the hardware is still functioning properly. Swift was not trained to recover from a crash. Human pilots are also very robust to changes in environmental conditions (e.g., lighting), which can significantly change the appearance of the track. In contrast, Swift's perception system assumes that the appearance of the environment is consistent with what was observed during training. If this assumption is not met, the system fails. Robustness to appearance changes can be provided by training the gate detector and the residual observation model under multiple conditions. Addressing these limitations allows the proposed method to be applied to autonomous drone racing, where access to the environment and the drone is limited[^25]."}),"\n",(0,r.jsx)(t.p,{children:"While many limitations remain and further research is needed, the achievement of world championship-level performance in a popular sport by an autonomous mobile robot is undoubtedly a milestone in robotics and machine intelligence. This work may inspire the widespread application of hybrid learning-based solutions in other physical systems, such as autonomous ground vehicles, aerial vehicles, and personal robots."}),"\n",(0,r.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(t.h3,{id:"quadrotor",children:"Quadrotor"}),"\n",(0,r.jsx)(t.h4,{id:"quadrotor-1",children:"Quadrotor"}),"\n",(0,r.jsx)(t.p,{children:"To enable large-scale training, we use a high-fidelity simulation of quadrotor dynamics. This section briefly describes the simulation process. The dynamics of the aircraft can be expressed as"}),"\n",(0,r.jsx)(t.p,{children:"$x\u02d9=[p\u02d9WBq\u02d9WBv\u02d9W\u03c9\u02d9B\u03a9\u02d9]=[vWqWB\u22c5[0\u03c9B/2]1m(qWB\u2299(fprop+faero))+gWJ\u22121(\u03c4prop+\u03c4mot+\u03c4aero+\u03c4iner)1kmot(\u03a9ss\u2212\u03a9)],$"}),"\n",(0,r.jsx)(t.p,{children:"$fprop=\u2211ifi,\u03c4prop=\u2211i\u03c4i+rP,i\xd7fi,$"}),"\n",(0,r.jsx)(t.p,{children:"\uff082\uff09"}),"\n",(0,r.jsx)(t.p,{children:"$\u03c4mot=Jm+p\u2211i\u03b6i\u03a9\u02d9i,\u03c4iner=\u2212\u03c9B\xd7J\u03c9B$"}),"\n",(0,r.jsx)(t.p,{children:"\uff083\uff09"}),"\n",(0,r.jsx)(t.p,{children:"$fi(\u03a9i)=[00cl\u22c5\u03a9i2]\u22a4,\u03c4i(\u03a9i)=[00cd\u22c5\u03a9i2]\u22a4$"}),"\n",(0,r.jsx)(t.p,{children:"\uff084\uff09"}),"\n",(0,r.jsxs)(t.p,{children:["where ",(0,r.jsx)(t.em,{children:"c"})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"l"})})})})})," and ",(0,r.jsx)(t.em,{children:"c"})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"d"})})})})})," represent the propeller lift coefficient and drag coefficient, respectively."]}),"\n",(0,r.jsx)(t.h4,{id:"aerodynamics-and",children:"Aerodynamics and"}),"\n",(0,r.jsx)(t.p,{children:"$fx\u223cvx+vx|vx|+\u03a92\xaf+vx\u03a92\xaffy\u223cvy+vy|vy|+\u03a92\xaf+vy\u03a92\xaffz\u223cvz+vz|vz|+vxy+vxy2+vxy\u03a92\xaf+vz\u03a92\xaf+vxyvz\u03a92\xaf\u03c4x\u223cvy+vy|vy|+\u03a92\xaf+vy\u03a92\xaf+vy|vy|\u03a92\xaf\u03c4y\u223cvx+vx|vx|+\u03a92\xaf+vx\u03a92\xaf+vx|vx|\u03a92\xaf\u03c4z\u223cvx+vy$"}),"\n",(0,r.jsx)(t.p,{children:"We then identify the corresponding coefficients from real flight data and use motion capture technology to provide ground-truth force and torque measurements. We then use data from the track to fit the dynamics model to the track. This is similar to the training a human pilot would perform on a specific track in the days or weeks before a race. In our case, the human pilot would practice on the same track for a week before the race."}),"\n",(0,r.jsx)(t.h4,{id:"betaflight-low-level",children:"Betaflight low-level"}),"\n",(0,r.jsx)(t.p,{children:"To control the quadrotor, the neural network outputs the total thrust and body velocity. Such control signals are known to be highly flexible and robust, making them easy to translate from simulation to reality[^44]. The predicted total thrust and body velocity are then processed by an onboard low-level controller, which calculates the individual motor commands and then converts these commands into analog voltage signals via the electronic speed controllers (ESCs) that control the motors. On the real aircraft, this low-level proportional-integral-derivative (PID) controller and ESC are implemented using open-source Betaflight and BLHeli32 firmware[^45]. In the simulation, we use accurate models of the low-level controller and motor speed controllers."}),"\n",(0,r.jsx)(t.p,{children:"Because the Betaflight PID controller is optimized for manned flight, it exhibits certain idiosyncrasies that simulation accurately captures: the D term's reference value is always zero (pure damping), the I term resets when the throttle is closed, and in the event of motor thrust saturation, airframe rate control takes priority (all motor signals are scaled down to avoid saturation). The controller gains used for simulation were identified from detailed logs of the Betaflight controller's internal states. Simulation was able to predict individual motor commands with an error of less than 1%."}),"\n",(0,r.jsx)(t.h4,{id:"battery-model-and",children:"Battery Model and"}),"\n",(0,r.jsxs)(t.p,{children:["The underlying controller converts each motor command into a pulse-width modulated (PWM) signal and sends it to the ESC, which controls the motor. Because the ESC does not perform closed-loop control of the motor speed, ",(0,r.jsx)("sub",{children:(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"the steady-state motor speed \u03a9 "})})})})})," ",(0,r.jsxs)("sub",{children:[(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"i"})})})})}),(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:",ss, given a PWM motor command cmd i, is a function of the battery voltage. Therefore, our simulation uses a gray-box battery model"})})})})]})," [^46] to model the battery voltage, which simulates the voltage based on the instantaneous power consumption ",(0,r.jsx)(t.em,{children:"P"})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"mot:"})})})})]}),"\n",(0,r.jsx)(t.p,{children:"$Pmot=cd\u03a93\u03b7$"}),"\n",(0,r.jsx)(t.p,{children:"\uff085\uff09"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)("sub",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"The battery model [^46] then"})})})})," simulates the battery voltage according to this power demand. Given the battery voltage ",(0,r.jsx)(t.em,{children:"Ubat"})," and the individual motor commands ",(0,r.jsx)(t.em,{children:"ucmd"})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", "})})})})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"i"})})})})}),", we use the mapping (again omitting the coefficients that multiply each summand)"]}),"\n",(0,r.jsx)(t.p,{children:"$\u03a9i,ss\u223c1+Ubat+ucmd,i+ucmd,i+Ubatucmd,i$"}),"\n",(0,r.jsx)(t.p,{children:"\uff086\uff09"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsxs)("sub",{children:[(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"Calculate the corresponding steady-state motor speeds \u03a9 i"})})})})}),(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:",ss"})})})})]})," required for the dynamics simulation in ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Equ1",children:"Equation (1"})," ). These coefficients have been identified from the Betaflight logs containing the measured values of all relevant quantities. Combined with the low-level controller model, this allows the simulator to correctly convert the actions in the form of total thrust and body velocity into the motor speeds \u03a9 ",(0,r.jsx)("sub",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"ss"})})})," ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Equ1",children:"required in Equation (1)"}),"."]}),"\n",(0,r.jsx)(t.h3,{id:"strategy",children:"Strategy"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"We train a deep neural control policy that directly maps observations o"})," t of the platform state and the next gated observation to control actions ",(0,r.jsx)(t.strong,{children:"u"})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"t in the form of "})})})})})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"mass-normalized collective thrust and body velocity"})})})})})})," [^44]. The control policy is trained in simulation using model-free reinforcement learning."]}),"\n",(0,r.jsx)(t.h4,{id:"training",children:"Training"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 31",title:"Schulman, J., Wolski, F., Dhariwal, P., Radford, A., and Klimov, O. Proximal Policy Optimization Algorithms. Preprint link: https://arxiv.org/abs/1707.06347 (2017).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR31",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"Training is performed using proximal policy optimization.31"})})})})})})," This \u201cactor-critic\u201d approach requires jointly optimizing two neural networks during training: a policy network (which maps observations to actions) and a value network (which acts as a \u201ccritic\u201d and evaluates the actions taken by the policy). After training, simply deploy the policy network on the robot."]}),"\n",(0,r.jsx)(t.h4,{id:"observe-act-and",children:"Observe, act, and"}),"\n",(0,r.jsx)(t.p,{children:"$rt=rtprog+rtperc+rtcmd\u2212rtcrash$"}),"\n",(0,r.jsx)(t.p,{children:"\uff087\uff09"}),"\n",(0,r.jsxs)(t.p,{children:["Among them, ",(0,r.jsx)(t.em,{children:"r"})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"prog"})})})})})," rewards progress towards the next door [^35]; ",(0,r.jsx)(t.em,{children:"r"})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"perc"})})})})})," encodes perception awareness by adjusting the vehicle posture so that the camera's optical axis points to the center of the next door; ",(0,r.jsx)(t.em,{children:"r"})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"cmd"})})})})})," rewards smooth movement; and ",(0,r.jsx)(t.em,{children:"r"})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"crash"})})})})})," is a binary penalty that only takes effect when colliding with a door or the platform leaves the predefined bounding box. If ",(0,r.jsx)(t.em,{children:"r"})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"crash"})})})})})," is triggered, the training process ends."]}),"\n",(0,r.jsx)(t.p,{children:"Specifically, the reward terms are as follows"}),"\n",(0,r.jsx)(t.p,{children:"$rtprog=\u03bb1[dt\u22121Gate\u2212dtGate]rtperc=\u03bb2exp\u2061[\u03bb3\u22c5\u03b4cam4]$"}),"\n",(0,r.jsx)(t.p,{children:"\uff088\uff09"}),"\n",(0,r.jsx)(t.p,{children:"$rtcmd=\u03bb4at\u03c9+\u03bb5\u2225at\u2212at\u22121\u22252$"}),"\n",(0,r.jsx)(t.p,{children:"\uff089\uff09"}),"\n",(0,r.jsx)(t.h4,{id:"training-1",children:"Training"}),"\n",(0,r.jsxs)(t.p,{children:["Data collection is performed in parallel by simulating 100 agents that interact with the environment in episodes of 1,500 steps. At each environment reset, each agent is initialized at a random gate on the track and generates bounded perturbations around the previously observed state as it passes through this gate. Unlike previous work44,49,50 ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 44",title:"Kaufmann, E.\u3001Bauersfeld, L. \u548c Scaramuzza, D. \u5728 2022 \u5e74\u56fd\u9645\u673a\u5668\u4eba\u4e0e\u81ea\u52a8\u5316\u4f1a\u8bae (ICRA) 10504\u201310510 (IEEE, 2022) \u4e2d\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR44",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:","})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:" we "})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 50",title:"Andrychowicz, O.M. et al. Learning dexterous hand-held manipulation. International Journal of Robotics Research 39, 3\u201320 (2020).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR50",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"do not randomize the platform dynamics "})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 49",title:"Molchanov, A. et al. In Proc. 2019 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS) 59\u201366 (IEEE, 2019).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR49",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"during"})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"training"})})})}),". Instead, we fine-tune on real data. The training environment is implemented using TensorFlow Agents [^51]. Both the policy and value networks are represented by two layers of perceptrons, each with 128 nodes and LeakyReLU activations with a negative slope of 0.2. The network parameters are optimized using the Adam optimizer, with a learning rate of 3 \xd7 10\u22124 for both the policy and value networks ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"."})})})})]}),"\n",(0,r.jsxs)(t.p,{children:["Policy training involved a total of 1 \xd7 10 ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"8"})})})})})," interactions with the environment and took 50 minutes on a workstation (i9 12900K, RTX 3090, 32 GB RAM DDR5). Fine-tuning involved 2 \xd7 10 ",(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"7"})})})})})," interactions with the environment."]}),"\n",(0,r.jsx)(t.h3,{id:"residual-model",children:"Residual Model"}),"\n",(0,r.jsx)(t.p,{children:"We fine-tune the original policy based on a small amount of data collected in the real world. Specifically, we collect three full rollouts in the real world, equivalent to approximately 50 seconds of flight time. We fine-tune the policy by identifying residual observations and residual dynamics, which are then used for simulated training. During this fine-tuning phase, only the weights of the control policy are updated, while the weights of the door detection network remain unchanged."}),"\n",(0,r.jsx)(t.h4,{id:"residual-observation",children:"Residual Observation"}),"\n",(0,r.jsx)(t.p,{children:"High-speed navigation results in severe motion blur, which can cause loss of tracked visual features and lead to significant drift in linear odometry estimates. We fine-tune the policy using an odometry model that is learned from only a small number of trials recorded in the real world. To model the drift in the odometry, we use Gaussian processes [^36] because they can fit the posterior distribution of odometry perturbations, from which we can sample time-consistent realizations."}),"\n",(0,r.jsx)(t.p,{children:"Specifically, a Gaussian process model fits the residual position, velocity, and pose as a function of the robot's ground truth state. Observation residuals are identified by comparing the visual inertial odometry (VIO) estimates observed during real-world rolling with the ground truth platform state obtained from an external motion tracking system."}),"\n",(0,r.jsx)(t.p,{children:"We treat each dimension of the observations separately, effectively fitting a set of nine one-dimensional Gaussian processes to the observation residuals. We use the hybrid radial basis function kernel"}),"\n",(0,r.jsx)(t.p,{children:"$\u03ba(zi,zj)=\u03c3f2exp\u2061(\u221212(zi\u2212zj)\u22a4L\u22122(zi\u2212zj))+\u03c3n2$"}),"\n",(0,r.jsx)(t.p,{children:"\uff0810\uff09"}),"\n",(0,r.jsxs)(t.p,{children:["Where ",(0,r.jsx)(t.em,{children:"L"})," is the diagonal length scale matrix, ",(0,r.jsx)(t.em,{children:"\u03c3f"})," and ",(0,r.jsx)(t.em,{children:"\u03c3n"})," represent the data and prior noise variances, respectively, ",(0,r.jsx)("sub",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"and "})})})})})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"zi "})})})})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"and"})})})})})," ",(0,r.jsx)(t.strong,{children:"zj"})," represent ",(0,r.jsx)(t.strong,{children:"the"})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"data"})})})})})," features. Kernel hyperparameters are optimized by maximizing the log-marginal likelihood. After kernel hyperparameter optimization, new realizations are sampled from the posterior distribution and then used to fine-tune the policy. Extended Data Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig5",children:"1"})," shows the residual observations of position, velocity, and pose from a real deployment, along with 100 realizations sampled from the Gaussian process model."]}),"\n",(0,r.jsx)(t.h4,{id:"residual-dynamics",children:"Residual Dynamics"}),"\n",(0,r.jsxs)(t.p,{children:["We use a residual model to supplement the simulated robot dynamics [^52]. Specifically, we determine the residual acceleration as a function of the platform state ",(0,r.jsx)(t.strong,{children:"s"})," and the command mass-normalized total thrust ",(0,r.jsx)(t.em,{children:"c"}),":"]}),"\n",(0,r.jsx)(t.p,{children:"$ares=KNN(s,c)$"}),"\n",(0,r.jsx)(t.p,{children:"\uff0811\uff09"}),"\n",(0,r.jsxs)(t.p,{children:["We used ",(0,r.jsx)(t.em,{children:"k- nearest neighbor regression"})," ",(0,r.jsx)(t.em,{children:"with k = 5."})," The size of the dataset used for residual dynamics model identification depends on the track layout and ranges between 800 and 1,000 samples for the track layout used in this study."]}),"\n",(0,r.jsx)(t.h3,{id:"door",children:"Door"}),"\n",(0,r.jsxs)(t.p,{children:["To correct for drift accumulated by the VIO pipeline, doors are used as different landmarks for relative localization. Specifically, doors are detected in the onboard camera view by segmenting their corners [^26]. Grayscale images provided by the Intel RealSense Tracking Camera T265 are used as input images for the door detector. The architecture of the segmentation network is a six-level U-Net [^53] with (8, 16, 16, 16, 16) convolutional filters of size (3, 3, 3, 5, 7, 7) at each level, and an additional layer operating on the output of the U-Net with 12 filters. LeakyReLU with ",(0,r.jsx)(t.em,{children:"\u03b1"})," \u2009= 0.01 is used as the activation function. For deployment on NVIDIA Jetson TX2, the network was ported to TensorRT. To optimize memory usage and computation time, inference is performed in half-precision mode (FP16) and the image is downsampled to 384 \xd7 384 before being fed into the network. On an NVIDIA Jetson TX2, one forward pass takes 40 milliseconds."]}),"\n",(0,r.jsx)(t.h3,{id:"vio-drift",children:"VIO drift"}),"\n",(0,r.jsxs)(t.p,{children:["Odometry estimates from the VIO pipeline54 ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 54",title:"Intel RealSense T265 Series Product Family. https://www.intelrealsense.com/wp-content/uploads/2019/09/Intel_RealSense_Tracking_Camera_Datasheet_Rev004_release.pdf (2019).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR54",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"can"})})})})})})," drift significantly during high-speed flight. We use gate detection to stabilize the pose estimates produced by VIO. The gate detector outputs the corner coordinates of all visible gates. We first estimate a relative pose for all predicted gates using infinitesimal plane-based pose estimation (IPPE) [^34]. Based on this relative pose estimate, each gate observation is assigned to the nearest gate in the known trajectory layout, resulting in an estimated pose of the drone."]}),"\n",(0,r.jsxs)(t.p,{children:["The state ",(0,r.jsx)(t.strong,{children:"x"})," and covariance ",(0,r.jsx)(t.em,{children:"P"})," updates are given by:"]}),"\n",(0,r.jsx)(t.p,{children:"$xk+1=Fxk,Pk+1=FPkF\u22a4+Q,$"}),"\n",(0,r.jsx)(t.p,{children:"\uff0812\uff09"}),"\n",(0,r.jsx)(t.p,{children:"$F=[I3\xd73dtI3\xd7303\xd73I3\xd73],Q=[\u03c3posI3\xd7303\xd7303\xd73\u03c3velI3\xd73].$"}),"\n",(0,r.jsx)(t.p,{children:"\uff0813\uff09"}),"\n",(0,r.jsx)(t.p,{children:"$Kk=Pk\u2212Hk\u22a4(HkPk\u2212Hk\u22a4+R)\u22121,xk+=xk\u2212+Kk(zk\u2212H(xk\u2212)),Pk+=(I\u2212KkHk)Pk\u2212,$"}),"\n",(0,r.jsx)(t.p,{children:"\uff0814\uff09"}),"\n",(0,r.jsxs)(t.p,{children:["where ",(0,r.jsx)(t.em,{children:"Kk"})," is the Kalman gain, ",(0,r.jsx)("sup",{children:(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"R"})})})})})})," ",(0,r.jsx)(t.em,{children:"is"})," the measurement covariance, ",(0,r.jsx)(t.em,{children:"and Hk"})," ",(0,r.jsx)("sub",{children:(0,r.jsx)("i",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"is"})})})})})})," the measurement matrix. If multiple doors are detected in a single camera frame, all relative pose estimates are stacked and processed in the same Kalman filter update step. The primary source of measurement error is the uncertainty in the network's door angle detections. When applying IPPE, this error in the image plane contributes to pose error. We chose a sampling-based approach to estimate pose error from the known average door angle detection uncertainty. For each door, the IPPE algorithm is applied to the nominal door observation and 20 perturbed door angle estimates. The resulting pose estimate distribution is then used to approximate the measurement covariance ",(0,r.jsx)(t.em,{children:"R of the door observations."})]}),"\n",(0,r.jsx)(t.h3,{id:"simulation",children:"Simulation"}),"\n",(0,r.jsx)(t.p,{children:"Achieving championship-level performance in autonomous drone racing requires overcoming two challenges: imperfect perception and incomplete models of the system dynamics. In simulated, controlled experiments, we evaluate the robustness of our approach to these two challenges. To this end, we evaluate its performance on competition tasks when deployed in four different settings. In setting (1), we simulate a simple quadrotor model with access to ground-truth state observations. In setting (2), we replace the ground-truth state observations with noisy observations identified from real flights. These noisy observations are generated by sampling a realization from the residual observation model and are independent of the perception awareness of the deployed controller. Settings (3) and (4) share the observation model with the first two settings, respectively, but replace the simple dynamics model with a more accurate aerodynamic simulation [^43]. These four settings allow for a controlled evaluation of the sensitivity of the approach to dynamic changes and observation fidelity."}),"\n",(0,r.jsxs)(t.p,{children:["In each of the four settings, we benchmark our approach against the following baselines: zero-shot, domain randomization, and time-optimal. The zero-shot baseline represents a learning-based race policy trained using model-free RL [^35] that is deployed from the training domain to the test domain at zero shot. The training domain of this policy is equal to the experimental setting (1), i.e., idealized dynamics and ground truth observations. Domain randomization extends the learning policy of the zero-shot baseline by randomizing the observations and dynamic properties to improve robustness. The time-optimal baseline uses pre-computed time-optimal trajectories28 ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 28",title:"Foehn, P., Romero, A. and Scaramuzza, D. Time-optimal planning of waypoint flight for quadrotors. Robotics, vol. 6, p. eabh1221 (2021).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR28",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:", tracked using an MPC controller. This approach shows the best performance "})})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"\u53c2\u8003\u6587\u732e 56",title:"Pham, H. & Pham, Q.-C. \u4e00\u79cd\u57fa\u4e8e\u53ef\u8fbe\u6027\u5206\u6790\u7684\u65f6\u95f4\u6700\u4f18\u8def\u5f84\u53c2\u6570\u5316\u65b0\u65b9\u6cd5\u3002IEEE \u673a\u5668\u4eba\u5b66\u62a5\uff0c34, 645\u2013659 (2018)\u3002",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR56",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"compared to other model-based time-optimal flight "})})})})})," ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 55",title:"Ryou, G., Tal, E., and Karaman, S. Multi-fidelity black-box optimization for time-optimal quadrotor maneuvers. International Journal of Robotics Research 40, 1352\u20131369 (2021).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR55",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"methods55,56"})})})})})}),(0,r.jsx)("sup",{children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"."})})})})," The dynamic models used for trajectory generation and the MPC controller match the simulated dynamics of the experimental setting (1)."]}),"\n",(0,r.jsx)(t.p,{children:"Performance is measured by the fastest lap time, the average and minimum observed distances successfully passed through the gate, and the percentage of successfully completed tracks. The gate distance metric measures the distance between the drone and the nearest point on the gate as it passes through the gate plane. A larger gate distance indicates that the quadrotor passes closer to the center of the gate. A smaller gate distance increases speed but also increases the risk of collision or missing the gate. Any lap resulting in a collision will not be considered valid."}),"\n",(0,r.jsxs)(t.p,{children:["The results are summarized in Extended Data Table ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Tab1",children:"1c"}),". All methods successfully complete the task when deployed in idealized dynamics and ground-truth observations, with the time-optimal baseline producing the lowest lap time. When deployed in a setting with domain shift, the performance of all baselines collapses, both in dynamics and observations, and none of the three baselines completes a single lap. This performance degradation is observed for both learning-based and traditional methods. In contrast, our method, which features empirical models of dynamics and observation noise, achieves success in all deployment settings, with a slight increase in lap time."]}),"\n",(0,r.jsxs)(t.p,{children:["The key to the success of our approach across various deployment regimes is that it uses empirical models of the dynamics and observation noise estimated from real data. Comparing methods that have access to such data with those that do not is not entirely fair. Therefore, we also benchmark the performance of all baseline methods when they have access to the same real data as our approach. Specifically, we compare performance in the experimental setting (2) where the dynamics model is idealized but the perception is noisy. All baseline methods provide predictions from the same Gaussian process model that we use to characterize the observation noise. The results are summarized in Extended Data Table ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Tab1",children:"1b"}),". All baseline methods benefit from more realistic observations, resulting in higher completion rates. However, our approach is the only one that can reliably complete the entire trajectory. In addition to the predictions from the observation noise model, our approach also accounts for model uncertainty. For an in-depth comparison of the performance of reinforcement learning and optimal control in controlled experiments, see Ref. [^57]."]}),"\n",(0,r.jsx)(t.h3,{id:"after-multiple-iterations",children:"after multiple iterations"}),"\n",(0,r.jsxs)(t.p,{children:["We investigated the extent to which behavior changes during the iterations. Our analysis showed that subsequent fine-tuning operations resulted in negligible improvements in performance and changes in behavior (Extended Data Fig. ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig6",children:"2"})," )."]}),"\n",(0,r.jsx)(t.p,{children:"Next, we provide more details about this investigation. We first list the fine-tuning steps to provide the necessary notation:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Train policy 0 in simulation."}),"\n",(0,r.jsx)(t.li,{children:"Deploy policy 0 in the real world. The policy is run on real data from a motion capture system."}),"\n",(0,r.jsx)(t.li,{children:"Identify the residuals observed by policy 0 in the real world."}),"\n",(0,r.jsx)(t.li,{children:"Policy 1 is trained by fine-tuning policy 0 on the identified residuals."}),"\n",(0,r.jsx)(t.li,{children:"Deploy Strategy 1 in the real world. This strategy only works on airborne sensor measurements."}),"\n",(0,r.jsx)(t.li,{children:"Identify the residuals observed by Strategy 1 in the real world."}),"\n",(0,r.jsx)(t.li,{children:"Strategy 2 is trained by fine-tuning Strategy 1 on the identified residuals."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["After fine-tuning their respective residuals, we compared the performance of Policy 1 and Policy 2 in simulation. The results are shown in Extended Data Figure ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4#Fig6",children:"2."})," We observed a difference in distance from the gate center (a measure of policy safety) of 0.09 \xb1 0.08 meters. Furthermore, the difference in the time required to complete a lap was 0.02 \xb1 0.02 seconds. Note that this lap time difference is significantly smaller than the 0.16-second difference between Swift and a human pilot."]}),"\n",(0,r.jsx)(t.h3,{id:"drone-hardware",children:"Drone hardware"}),"\n",(0,r.jsxs)(t.p,{children:["The quadrotors used by human pilots and Swift have the same weight, shape, and propulsion. The platform design is based on the Agilicious framework58 ",(0,r.jsx)("sup",{children:(0,r.jsx)("a",{"aria-label":"Reference 58",title:"Foehn, P. et al. Agilicious: An open-source and open-hardware agile quadrotor for vision-based flight. Robotics Science, 7, eabl6259 (2022).",href:"https://www.nature.com/articles/s41586-023-06419-4#ref-CR58",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:(0,r.jsx)("font",{dir:"auto",children:"."})})})})})})," Each vehicle weighs 870 grams and can produce a maximum static thrust of approximately 35 Newtons, resulting in a static thrust-to-weight ratio of 4.1. The base of each platform consists of an Armattan Chameleon 6-inch mainframe equipped with a T-Motor Velox 2306 motor and a 5-inch three-bladed propeller. The NVIDIA Jetson TX2 equipped with a Connect Tech Quasar carrier board provides the primary computing resources for the autonomous drones, featuring a six-core CPU running at 2 GHz and a dedicated GPU with 256 CUDA cores running at 1.3 GHz. While the forward pass of the door detection network is executed on the GPU, the competition policy is evaluated on the CPU, with one inference pass taking 8 milliseconds. The autonomous drone is equipped with an Intel RealSense tracking camera T265, which provides 100 Hz VIO estimates[^59] and transmits them via USB to an NVIDIA Jetson TX2. The manned drone does not have a Jetson computer or a RealSense camera, but is equipped with corresponding ballast. Control commands such as total thrust and body velocity generated by the human pilot or Swift are sent to a commercial flight controller running on a 216 MHz STM32 processor. The flight controller runs Betaflight, an open source flight control software[^45]."]}),"\n",(0,r.jsx)(t.h3,{id:"human-pilot",children:"Human pilot"}),"\n",(0,r.jsx)(t.p,{children:"The following quotes convey the impressions of the three human champions who competed against Swift."}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Alex Vanover"}),":"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"These races will be decided in the S-segment, the most challenging section of the course."}),"\n",(0,r.jsx)(t.li,{children:"It was a fantastic race! I was so close to the autonomous drone that I could feel the rush of air as I tried to keep up."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Thomas Bitmata"}),":"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"The possibilities are endless, and this is the beginning of something that could change the world. On the other hand, I'm a race car driver, and I don't want anything to be faster than me."}),"\n",(0,r.jsx)(t.li,{children:"As you fly faster, you sacrifice accuracy for speed."}),"\n",(0,r.jsx)(t.li,{children:"The potential for drones is exciting. Soon, AI-powered drones may even be used as training tools to help people understand their future possibilities."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Marvin Schepper"}),":"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"It\u2019s a very different feeling racing against a machine because you know the machine won\u2019t get tired."}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"research",children:"Research"}),"\n",(0,r.jsx)(t.p,{children:"This study was conducted in accordance with the Declaration of Helsinki. According to the regulations of the University of Zurich, this study protocol did not require ethics committee review because no health-related data were collected. Participants provided written informed consent before participating in the study."}),"\n",(0,r.jsx)(t.h2,{id:"data",children:"Data"}),"\n",(0,r.jsxs)(t.p,{children:["All other data required to evaluate the conclusions of this paper are included in the paper or in the Extended Data. Motion capture recordings of the event and their analysis code are available in the file \u201cracing_data.zip\u201d from Zenodo at ",(0,r.jsx)(t.a,{href:"https://doi.org/10.5281/zenodo.7955278",children:"https://doi.org/10.5281/zenodo.7955278"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"code",children:"Code"}),"\n",(0,r.jsxs)(t.p,{children:["The Swift pseudocode detailing the training process and algorithm can be found in the file \u201cpseudocode.zip\u201d from Zenodo at ",(0,r.jsx)(t.a,{href:"https://doi.org/10.5281/zenodo.7955278",children:"https://doi.org/10.5281/zenodo.7955278"}),". To prevent potential misuse, the full source code associated with this research will not be made public."]}),"\n",(0,r.jsx)(t.h2,{id:"more",children:"More"}),"\n",(0,r.jsxs)(t.p,{children:["Paper address: ",(0,r.jsx)(t.a,{href:"https://www.nature.com/articles/s41586-023-06419-4",children:"https://www.nature.com/articles/s41586-023-06419-4"})]})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>s});var n=i(6540);const r={},a=n.createContext(r);function o(e){const t=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);